# 第3章 凸优化问题

## 3.1 优化问题的基本形式

### 3.1.1 优化问题的标准形式

一个一般的优化问题可以表示为：

$$\min_{x} f(x)$$

$$\text{s.t. } g_i(x) \leq 0, \quad i=1,2,\ldots,m$$

$$h_j(x) = 0, \quad j=1,2,\ldots,p$$

其中：
- $f: \mathbb{R}^n \to \mathbb{R}$ 是目标函数
- $g_i: \mathbb{R}^n \to \mathbb{R}, i=1,2,\ldots,m$ 是不等式约束函数
- $h_j: \mathbb{R}^n \to \mathbb{R}, j=1,2,\ldots,p$ 是等式约束函数
- $x \in \mathbb{R}^n$ 是优化变量

我们的目标是在满足约束条件的情况下，找到使目标函数最小化的变量 $x$。

### 3.1.2 可行解与最优解

#### 可行解

如果一个点 $x$ 满足所有的约束条件，即：

$$g_i(x) \leq 0, \quad i=1,2,\ldots,m$$

$$h_j(x) = 0, \quad j=1,2,\ldots,p$$

则称 $x$ 是该优化问题的可行解。所有可行解的集合称为可行域，记为 $D$：

$$D = \{x \in \mathbb{R}^n \mid g_i(x) \leq 0, i=1,2,\ldots,m; h_j(x) = 0, j=1,2,\ldots,p\}$$

#### 最优解

如果一个可行解 $x^*$ 满足：对于所有的可行解 $x \in D$，都有 $f(x^*) \leq f(x)$，则称 $x^*$ 是该优化问题的最优解。最优解对应的目标函数值称为最优值，记为 $p^* = f(x^*)$。

### 3.1.3 局部最优与全局最优

#### 局部最优解

对于一个优化问题，如果存在一个正数 $r$，使得对于所有满足 $\lVert x - x^* \rVert \leq r$ 的可行解 $x$，都有 $f(x^*) \leq f(x)$，则称 $x^*$ 是该优化问题的局部最优解。

#### 全局最优解

如果对于所有的可行解 $x$，都有 $f(x^*) \leq f(x)$，则称 $x^*$ 是该优化问题的全局最优解。

显然，全局最优解一定是局部最优解，但局部最优解不一定是全局最优解。对于非凸优化问题，可能存在多个局部最优解，这使得求解变得困难。而对于凸优化问题，局部最优解就是全局最优解，这是凸优化的一个重要优势。

## 3.2 凸优化问题的定义与性质

### 3.2.1 凸优化问题的标准形式

凸优化问题是指目标函数是凸函数，不等式约束函数是凸函数，等式约束函数是仿射函数的优化问题。其标准形式为：

$$\min_{x} f(x)$$

$$\text{s.t. } g_i(x) \leq 0, \quad i=1,2,\ldots,m$$

$$Ax = b$$

其中：
- $f: \mathbb{R}^n \to \mathbb{R}$ 是凸函数
- $g_i: \mathbb{R}^n \to \mathbb{R}, i=1,2,\ldots,m$ 是凸函数
- $A \in \mathbb{R}^{p \times n}$，$b \in \mathbb{R}^p$，$Ax = b$ 是仿射等式约束

### 3.2.2 凸优化问题的最优性条件

对于凸优化问题，最优解的判定条件相对简单。

#### 无约束凸优化问题的最优性条件

对于无约束凸优化问题：

$$\min_{x} f(x)$$

其中 $f$ 是凸函数且可微，$x^*$ 是最优解的充要条件是梯度为零：

$$\nabla f(x^*) = 0$$

#### 约束凸优化问题的最优性条件

对于约束凸优化问题，最优解的判定需要用到KKT条件（Karush-Kuhn-Tucker条件），这将在第5章中详细介绍。

### 3.2.3 凸优化问题的等价变换

凸优化问题可以通过以下变换保持凸性：

1. **变量替换**：如果 $x = By + c$，其中 $B \in \mathbb{R}^{n \times m}$，$c \in \mathbb{R}^n$，则原问题可以转换为关于 $y$ 的凸优化问题。

2. **目标函数的变换**：如果 $h$ 是单调递增的凸函数，$f$ 是凸函数，则 $h(f(x))$ 是凸函数，可以作为新的目标函数。

3. **约束的变换**：
   - 对于不等式约束 $g_i(x) \leq 0$，可以替换为 $h(g_i(x)) \leq 0$，其中 $h$ 是单调递增的凸函数。
   - 对于等式约束 $Ax = b$，可以保持不变。

4. **松弛变量**：对于不等式约束 $g_i(x) \leq 0$，可以引入松弛变量 $s_i \geq 0$，将其转换为等式约束 $g_i(x) + s_i = 0$。

## 3.3 常见的凸优化问题

### 3.3.1 线性规划(LP)

线性规划是最简单的凸优化问题之一，其目标函数和约束函数都是线性的。线性规划的标准形式为：

$$\min_{x} c^T x$$

$$\text{s.t. } Ax \leq b$$

$$x \geq 0$$

其中：
- $c \in \mathbb{R}^n$ 是目标函数系数向量
- $A \in \mathbb{R}^{m \times n}$ 是约束矩阵
- $b \in \mathbb{R}^m$ 是约束右侧向量

线性规划的可行域是一个凸多面体，最优解（如果存在）一定在可行域的顶点上。

#### 线性规划的示例

**生产计划问题**：某工厂生产两种产品，产品1和产品2。生产每单位产品1需要消耗2单位原料A和1单位原料B，可获利3元；生产每单位产品2需要消耗1单位原料A和2单位原料B，可获利4元。工厂现有原料A 100单位，原料B 80单位。问如何安排生产计划，使得总利润最大？

**建模**：设生产产品1的数量为 $x_1$，生产产品2的数量为 $x_2$。则问题可以建模为：

$$\max 3x_1 + 4x_2$$

$$\text{s.t. } 2x_1 + x_2 \leq 100$$

$$x_1 + 2x_2 \leq 80$$

$$x_1, x_2 \geq 0$$

这是一个线性规划问题，可以通过单纯形法或内点法求解。

### 3.3.2 二次规划(QP)

二次规划是目标函数为二次函数，约束函数为线性函数的凸优化问题。二次规划的标准形式为：

$$\min_{x} \frac{1}{2} x^T P x + q^T x$$

$$\text{s.t. } Ax \leq b$$

其中：
- $P \in \mathbb{R}^{n \times n}$ 是对称半正定矩阵（保证目标函数是凸函数）
- $q \in \mathbb{R}^n$ 是线性项系数向量
- $A \in \mathbb{R}^{m \times n}$ 是约束矩阵
- $b \in \mathbb{R}^m$ 是约束右侧向量

当 $P$ 是正定矩阵时，目标函数是严格凸的，此时二次规划问题有唯一的最优解（如果可行域非空）。

#### 二次规划的示例

**投资组合优化问题**：假设我们有 $n$ 种资产，每种资产的预期收益率为 $r_i$，方差为 $\sigma_i^2$，资产 $i$ 和资产 $j$ 之间的协方差为 $\sigma_{ij}$。我们希望投资这 $n$ 种资产，使得投资组合的预期收益率不低于 $r_0$，同时投资组合的风险（方差）最小。

**建模**：设投资于资产 $i$ 的比例为 $x_i$，则投资组合的预期收益率为 $\sum_{i=1}^n r_i x_i$，投资组合的方差为 $x^T \Sigma x$，其中 $\Sigma$ 是协方差矩阵。问题可以建模为：

$$\min_{x} x^T \Sigma x$$

$$\text{s.t. } \sum_{i=1}^n r_i x_i \geq r_0$$

$$\sum_{i=1}^n x_i = 1$$

$$x_i \geq 0, \quad i=1,2,\ldots,n$$

这是一个二次规划问题，因为目标函数是二次的，约束函数是线性的。

### 3.3.3 二次约束二次规划(QCQP)

二次约束二次规划是目标函数和约束函数都是二次函数的凸优化问题。其标准形式为：

$$\min_{x} \frac{1}{2} x^T P_0 x + q_0^T x + r_0$$

$$\text{s.t. } \frac{1}{2} x^T P_i x + q_i^T x + r_i \leq 0, \quad i=1,2,\ldots,m$$

其中：
- $P_0, P_1, \ldots, P_m$ 是对称半正定矩阵（保证目标函数和约束函数都是凸函数）
- $q_0, q_1, \ldots, q_m$ 是线性项系数向量
- $r_0, r_1, \ldots, r_m$ 是常数项

#### 二次约束二次规划的示例

**波束形成问题**：在无线通信中，我们希望设计一个波束形成器，使得信号在目标方向的增益最大，同时在干扰方向的增益不超过某个阈值。

**建模**：设波束形成器的权重向量为 $w$，目标方向的导向矢量为 $a(\theta_0)$，干扰方向的导向矢量为 $a(\theta_i), i=1,2,\ldots,m$。则问题可以建模为：

$$\max_{w} |w^H a(\theta_0)|^2$$

$$\text{s.t. } |w^H a(\theta_i)|^2 \leq \gamma_i, \quad i=1,2,\ldots,m$$

$$w^H w \leq P$$

其中 $P$ 是功率约束。这是一个二次约束二次规划问题。

### 3.3.4 半正定规划(SDP)

半正定规划是约束包含半正定矩阵约束的凸优化问题。其标准形式为：

$$\min_{X} \text{tr}(C^T X)$$

$$\text{s.t. } \text{tr}(A_i^T X) = b_i, \quad i=1,2,\ldots,m$$

$$X \succeq 0$$

其中：
- $X \in \mathbb{S}^n$ 是优化变量（对称矩阵）
- $C, A_1, \ldots, A_m \in \mathbb{S}^n$ 是给定的对称矩阵
- $b_1, \ldots, b_m \in \mathbb{R}$ 是给定的标量
- $X \succeq 0$ 表示 $X$ 是半正定矩阵

半正定规划是一种非常强大的凸优化问题，许多其他类型的凸优化问题都可以转换为半正定规划问题。

#### 半正定规划的示例

**最大割问题的松弛**：给定一个无向图 $G=(V,E)$，每条边 $(i,j)$ 有一个权重 $w_{ij} \geq 0$。最大割问题是将顶点集 $V$ 划分为两个子集 $S$ 和 $V\setminus S$，使得割集（一个顶点在 $S$ 中，另一个顶点在 $V\setminus S$ 中的边）的总权重最大。

**建模**：最大割问题可以建模为：

$$\max_{x} \frac{1}{4} \sum_{i,j} w_{ij} (1 - x_i x_j)$$

$$\text{s.t. } x_i \in \{-1, 1\}, \quad i=1,2,\ldots,n$$

这是一个整数规划问题，不是凸的。但是，我们可以将其松弛为半正定规划问题：

$$\max_{X} \frac{1}{4} \sum_{i,j} w_{ij} (1 - X_{ij})$$

$$\text{s.t. } X_{ii} = 1, \quad i=1,2,\ldots,n$$

$$X \succeq 0$$

其中 $X \in \mathbb{S}^n$ 是半正定矩阵。

### 3.3.5 几何规划(GP)

几何规划是目标函数和约束函数都是广义多项式的优化问题。广义多项式是形如：

$$f(x) = \sum_{k=1}^K c_k x_1^{a_{k1}} x_2^{a_{k2}} \cdots x_n^{a_{kn}}$$

其中 $c_k > 0$，$a_{ki} \in \mathbb{R}$。

几何规划的标准形式为：

$$\min_{x} f_0(x)$$

$$\text{s.t. } f_i(x) \leq 1, \quad i=1,2,\ldots,m$$

$$h_j(x) = 1, \quad j=1,2,\ldots,p$$

其中：
- $f_0$ 是正项式（所有项的系数都是正的广义多项式）
- $f_i$ 是正项式
- $h_j$ 是单项式（只有一项的正项式）

通过变量替换 $y_i = \log x_i$，几何规划可以转换为凸优化问题（称为凸几何规划）。

#### 几何规划的示例

**电路设计问题**：在电路设计中，我们希望最小化电路的面积，同时满足延迟、功耗等约束。

**建模**：设 $x_1, x_2, \ldots, x_n$ 是电路中各个器件的尺寸，电路的面积可以表示为正项式 $f_0(x)$，延迟可以表示为正项式 $f_1(x)$，功耗可以表示为正项式 $f_2(x)$。则问题可以建模为：

$$\min_{x} f_0(x)$$

$$\text{s.t. } f_1(x) \leq T$$

$$f_2(x) \leq P$$

$$x_i \geq x_{i,min}, \quad i=1,2,\ldots,n$$

这是一个几何规划问题。

## 3.4 小结

本章介绍了凸优化问题的基本概念和性质，包括：

1. **优化问题的基本形式**：标准形式、可行解与最优解、局部最优与全局最优。

2. **凸优化问题的定义与性质**：标准形式、最优性条件、等价变换。

3. **常见的凸优化问题**：
   - 线性规划(LP)
   - 二次规划(QP)
   - 二次约束二次规划(QCQP)
   - 半正定规划(SDP)
   - 几何规划(GP)

这些凸优化问题在实际应用中非常常见，掌握它们的形式和性质对于解决实际问题至关重要。在接下来的章节中，我们将学习如何设计算法来求解这些凸优化问题，以及如何将实际问题建模为凸优化问题。

## 习题

### 习题3.1
将下列问题转化为标准形式的线性规划问题：

$$ \max_{x} 2x_1 + 3x_2$$  

$$\text{s.t. } x_1 + x_2 \leq 5$$

$$2x_1 + x_2 \leq 8$$

$$x_1, x_2 \geq 0$$

**注**：习题解答见第8章附录。