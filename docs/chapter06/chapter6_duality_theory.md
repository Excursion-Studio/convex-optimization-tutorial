# 第6章 对偶理论

## 6.1 拉格朗日对偶

对偶理论是凸优化的重要组成部分，它通过构造对偶问题来提供原问题最优值的下界，同时为求解原问题提供了新的思路。

### 6.1.1 拉格朗日函数

考虑凸优化问题：

$$\min_{x} f(x)$$

$$\text{s.t. } g_i(x) \leq 0, \quad i=1,2,\ldots,m$$

$$h_j(x) = 0, \quad j=1,2,\ldots,p$$

其中 $f$ 和 $g_i$ 都是凸函数，$h_j$ 是仿射函数。

拉格朗日函数定义为：

$$L(x, \mu, \lambda) = f(x) - \sum_{i=1}^m \mu_i g_i(x) - \sum_{j=1}^p \lambda_j h_j(x)$$

其中 $\mu_i \geq 0$ 是不等式约束的拉格朗日乘数，$\lambda_j$ 是等式约束的拉格朗日乘数。

### 6.1.2 对偶函数与对偶问题

#### 对偶函数

对偶函数 $d: \mathbb{R}^m \times \mathbb{R}^p \to \mathbb{R}$ 定义为拉格朗日函数关于 $x$ 的最小值：

$$d(\mu, \lambda) = \inf_{x \in \text{dom}(f)} L(x, \mu, \lambda)$$

对偶函数具有以下重要性质：

1. **对偶函数是凹函数**：无论原问题是否凸，对偶函数都是凹函数，因为它是关于 $(\mu, \lambda)$ 的仿射函数的逐点下确界。
2. **对偶函数给出原问题最优值的下界**：对于任意 $\mu \geq 0$ 和 $\lambda$，有 $d(\mu, \lambda) \leq p^*$，其中 $p^*$ 是原问题的最优值。

#### 对偶问题

对偶问题是在对偶函数的基础上构造的最大化问题：

$$\max_{\mu, \lambda} d(\mu, \lambda)$$

$$\text{s.t. } \mu_i \geq 0, \quad i=1,2,\ldots,m$$

对偶问题是一个凸优化问题，因为目标函数是凹函数，约束是线性的。

#### 对偶问题的最优值

对偶问题的最优值记为 $d^*$，即：

$$d^* = \sup_{\mu \geq 0, \lambda} d(\mu, \lambda)$$

根据对偶函数的性质，我们有 $d^* \leq p^*$，这一不等式称为**弱对偶性**。

### 6.1.3 弱对偶与强对偶

#### 弱对偶性

对于任意优化问题（不一定是凸的），弱对偶性成立，即对偶问题的最优值不超过原问题的最优值：

$$d^* \leq p^*$$

弱对偶性给出了原问题最优值的一个下界，这在某些情况下是非常有用的。

#### 强对偶性

如果 $d^* = p^*$，则称强对偶性成立。对于凸优化问题，在一定条件下，强对偶性成立。

#### 对偶间隙

原问题最优值与对偶问题最优值之间的差值称为对偶间隙：

$$p^* - d^*$$

对偶间隙总是非负的，当强对偶性成立时，对偶间隙为零。

### 6.1.4 Slater条件与其他约束规范

Slater条件是保证凸优化问题强对偶性成立的一个充分条件。

#### Slater条件

对于凸优化问题：

$$\min_{x} f(x)$$

$$\text{s.t. } g_i(x) \leq 0, \quad i=1,2,\ldots,m$$

$$Ax = b$$

其中 $f$ 和 $g_i$ 都是凸函数，Slater条件表述为：存在一个点 $x$ 使得：

$$g_i(x) < 0, \quad i=1,2,\ldots,m$$

$$Ax = b$$

这样的点称为**严格可行点**。

如果 Slater条件满足，则强对偶性成立，即 $d^* = p^*$。

#### 其他约束规范

除了 Slater条件，还有其他一些约束规范可以保证强对偶性成立，例如：

1. **线性约束的Slater条件**：对于仅含线性不等式约束和线性等式约束的凸优化问题，Slater条件简化为存在可行点。
2. **KKT约束规范**：如果原问题的最优解满足KKT条件，并且KKT乘子存在，则强对偶性成立。
3. **RSC（Restricted Slater Condition）**：对于某些特殊的凸优化问题，如半正定规划，存在相应的Slater条件变体。

## 6.2 对偶性的应用

对偶理论在凸优化中有广泛的应用，包括求解原问题、灵敏度分析、获得下界等。

### 6.2.1 对偶问题的求解

对于某些凸优化问题，对偶问题可能比原问题更容易求解。通过求解对偶问题，然后利用强对偶性和互补松弛条件，可以得到原问题的最优解。

#### 对偶问题求解步骤

1. 构造原问题的拉格朗日函数。
2. 推导对偶函数，即拉格朗日函数关于 $x$ 的最小值。
3. 构造对偶问题，即最大化对偶函数。
4. 求解对偶问题，得到最优对偶变量 $(\mu^*, \lambda^*)$。
5. 利用互补松弛条件和梯度条件，求解原问题的最优解 $x^*$。

#### 示例：线性规划的对偶

考虑线性规划原问题：

$$\min_{x} c^T x$$

$$\text{s.t. } Ax \leq b$$

$$x \geq 0$$

其拉格朗日函数为：

$$L(x, \mu, \nu) = c^T x - \mu^T (Ax - b) - \nu^T x = (c - A^T \mu - \nu)^T x + \mu^T b$$

其中 $\mu \geq 0$ 和 $\nu \geq 0$ 是拉格朗日乘数。

对偶函数为：

$$d(\mu, \nu) = \inf_{x} L(x, \mu, \nu) = \begin{cases}
\mu^T b, & A^T \mu + \nu = c \\
-\infty, & \text{otherwise}
\end{cases}$$

对偶问题为：

$$\max_{\mu, \nu} \mu^T b$$

$$\text{s.t. } A^T \mu + \nu = c$$

$$\mu \geq 0, \nu \geq 0$$

消除 $\nu$ 后，对偶问题可简化为：

$$\max_{\mu} \mu^T b$$

$$\text{s.t. } A^T \mu \leq c$$

$$\mu \geq 0$$

### 6.2.2 灵敏度分析

对偶理论可以用于分析原问题最优值对约束右侧参数的灵敏度。

#### 最优值的灵敏度

考虑凸优化问题：

$$p^*(b) = \min_{x} f(x)$$

$$\text{s.t. } g_i(x) \leq b_i, \quad i=1,2,\ldots,m$$

$$h_j(x) = c_j, \quad j=1,2,\ldots,p$$

其中 $b = (b_1, \ldots, b_m)^T$ 是约束右侧参数。

如果强对偶性成立，且 $p^*(b)$ 可微，则：

$$\nabla p^*(b) = -\mu^*$$

其中 $\mu^*$ 是对偶问题的最优解。

这一结果表明，对偶变量 $\mu^*_i$ 表示原问题最优值对约束 $i$ 右侧参数 $b_i$ 的灵敏度，即 $b_i$ 增加一个单位时，最优值的减少量。

#### 示例：资源分配问题的灵敏度

考虑资源分配问题：

$$\max_{x} \sum_{i=1}^n c_i x_i$$

$$\text{s.t. } \sum_{i=1}^n a_{ji} x_i \leq b_j, \quad j=1,2,\ldots,m$$

$$x_i \geq 0, \quad i=1,2,\ldots,n$$

其中 $x_i$ 是第 $i$ 种产品的产量，$c_i$ 是单位利润，$a_{ji}$ 是生产单位产品 $i$ 所需的资源 $j$ 的数量，$b_j$ 是资源 $j$ 的可用量。

对偶变量 $\mu^*_j$ 表示资源 $j$ 的影子价格，即增加一单位资源 $j$ 所能带来的最大利润增加量。

### 6.2.3 对偶间隙的利用

对偶间隙可以用于评估优化算法的性能，以及在某些情况下提供近似解的质量保证。

#### 对偶间隙作为停止准则

在求解凸优化问题时，可以同时计算原问题的目标函数值 $f(x^k)$ 和对偶问题的目标函数值 $d(\mu^k, \lambda^k)$，当它们的差值（对偶间隙）小于预设阈值时，停止迭代。

#### 近似解的质量保证

如果对偶间隙较小，则当前的原问题可行解和对偶问题可行解分别给出了原问题最优值的上界和下界，从而可以评估近似解的质量。

## 6.3 鞍点解释

对偶理论与鞍点问题密切相关，鞍点可以为对偶理论提供几何解释。

### 6.3.1 鞍点的定义

对于函数 $L(x, \mu, \lambda)$，如果存在点 $(x^*, \mu^*, \lambda^*)$ 使得：

$$L(x^*, \mu, \lambda) \leq L(x^*, \mu^*, \lambda^*) \leq L(x, \mu^*, \lambda^*)$$

对于所有 $x \in \text{dom}(f)$，$\mu \geq 0$，则称 $(x^*, \mu^*, \lambda^*)$ 是 $L$ 的一个鞍点。

### 6.3.2 鞍点与最优解的关系

#### 鞍点与原问题最优解

如果 $(x^*, \mu^*, \lambda^*)$ 是拉格朗日函数 $L$ 的一个鞍点，并且 $\mu^* \geq 0$，则 $x^*$ 是原问题的最优解，$(\mu^*, \lambda^*)$ 是对偶问题的最优解，且强对偶性成立（$p^* = d^*$）。

#### 原问题最优解与鞍点

如果原问题是凸的，强对偶性成立，$x^*$ 是原问题的最优解，$(\mu^*, \lambda^*)$ 是对偶问题的最优解，并且它们满足KKT条件，则 $(x^*, \mu^*, \lambda^*)$ 是拉格朗日函数 $L$ 的一个鞍点。

### 6.3.3 极大极小不等式

极大极小不等式是对偶理论的一个重要结果，它与鞍点密切相关。

#### 极大极小不等式的表述

对于任意函数 $L(x, \mu, \lambda)$，有：

$$\sup_{\mu \geq 0, \lambda} \inf_{x} L(x, \mu, \lambda) \leq \inf_{x} \sup_{\mu \geq 0, \lambda} L(x, \mu, \lambda)$$

当且仅当存在鞍点时，等号成立。

#### 极大极小不等式与对偶理论的关系

在对偶理论中，左侧是对偶问题的最优值 $d^*$，右侧是原问题的最优值 $p^*$，因此极大极小不等式正是弱对偶性的体现。当强对偶性成立时，等号成立，此时存在鞍点。

## 6.4 小结

本章介绍了对偶理论的基本概念和应用，包括：

1. **拉格朗日对偶**：
   - 拉格朗日函数：将约束优化问题转化为无约束优化问题的工具。
   - 对偶函数：拉格朗日函数关于原变量的最小值，是凹函数。
   - 对偶问题：最大化对偶函数，是凸优化问题。
   - 弱对偶性：对偶问题的最优值不超过原问题的最优值。
   - 强对偶性：对偶问题的最优值等于原问题的最优值。
   - Slater条件：保证强对偶性成立的充分条件。

2. **对偶性的应用**：
   - 对偶问题的求解：通过求解对偶问题来获得原问题的最优解。
   - 灵敏度分析：利用对偶变量分析原问题最优值对约束参数的灵敏度。
   - 对偶间隙的利用：评估优化算法的性能和近似解的质量。

3. **鞍点解释**：
   - 鞍点的定义：函数在某一点处同时达到关于某些变量的最大值和关于其他变量的最小值。
   - 鞍点与最优解的关系：鞍点对应于原问题和对偶问题的最优解。
   - 极大极小不等式：对偶理论的数学基础，体现了弱对偶性。

对偶理论是凸优化的重要组成部分，它不仅为求解凸优化问题提供了新的思路，还为理解优化问题的性质和设计高效算法奠定了基础。在实际应用中，对偶理论被广泛用于机器学习、信号处理、控制系统等领域。

在下一章中，我们将介绍凸优化在各个领域的应用案例，以帮助读者更好地理解和应用凸优化技术。

## 习题

### 基础题

**习题6.1**：写出下列线性规划问题的对偶问题：

$$\min_{x} 3x_1 + 4x_2$$

$$\text{s.t. } x_1 + x_2 \geq 1$$

$$2x_1 + x_2 \geq 2$$

$$x_1, x_2 \geq 0$$

**习题6.2**：简述对偶理论的基本思想。

**习题6.3**：写出下列线性规划问题的对偶问题：

$$\max_{x} 2x_1 + 3x_2$$

$$\text{s.t. } x_1 + x_2 \leq 5$$

$$2x_1 + x_2 \leq 8$$

$$x_1, x_2 \geq 0$$

### 中等题

**习题6.4**：证明弱对偶性，即对于原问题和对偶问题，对偶问题的目标函数值不超过原问题的目标函数值（极小化问题）。

**习题6.5**：证明强对偶性，即对于凸优化问题，当满足 Slater 条件时，原问题和对偶问题的最优值相等。

**习题6.6**：使用对偶理论求解下列线性规划问题：

$$\min_{x} x_1 + x_2$$

$$\text{s.t. } x_1 + 2x_2 \geq 3$$

$$2x_1 + x_2 \geq 3$$

$$x_1, x_2 \geq 0$$

习题解答[点击这里](quiz/exercise_solutions.md)
